<!DOCTYPE html>
<html>
<head>
  <title>Chat Room</title>
  <style>
    #chat-log {
      list-style-type: none;
      margin: 0;
      padding: 0;
    }
  </style>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="join-form">
    <h1>Join the Chat Room</h1>
    <label for="username">Username:</label>
    <input type="text" id="username" />
    <button onclick="joinChat()">Join</button>
  </div>
  <div id="chat-form" style="display:none;">
    <h1>Chat Room</h1>
    <ul id="chat-log"></ul>
    <label for="message">Message:</label>
    <input type="text" id="message" />
    <button onclick="sendMessage()">Send</button>
  </div>
  <script>
    const socket = new WebSocket('ws://chatroom-khuv.onrender.com');
    const chatLog = document.getElementById('chat-log');
    const username = document.getElementById('username');
    const messageInput = document.getElementById('message');

    function joinChat() {
      const name = username.value.trim();
      if (!name) return;
      socket.send(JSON.stringify({ type: 'join', name }));
      document.getElementById('join-form').style.display = 'none';
      document.getElementById('chat-form').style.display = 'block';
    }

    function sendMessage() {
      const message = messageInput.value.trim();
      if (!message) return;
      socket.send(JSON.stringify({ type: 'message', name: username.value, message }));
      messageInput.value = '';
    }

    socket.onmessage = (event) => {
      const data = JSON.parse(event.data);
      if (data.type === 'message') {
        const message = `${data.name}: ${data.message}`;
        const newMessage = document.createElement('li');
        newMessage.textContent = message;
        chatLog.appendChild(newMessage);
      }
    };
  </script>
</body>
</html>